@use "color-utils" as *;
@use "variables" as *;
@use "../../node_modules/bootstrap/scss/bootstrap" as bs;
@use "mixins";
@use "layout";
@use "editor";
@use "prettify";
@use "ui";

// deployd specific (icon classes removed; using Bootstrap Icons instead)

body {
  background: url(../img/outlets.png) #030202;
  color: $white;
}

.label {
  vertical-align: inherit !important;
} // fixes bootstrap
h1 {
  padding: 10px;
}

h3 {
  .header-link {
    display: block;
    float: right;
    font-size: $baseFontSize;
    font-family: $baseFontFamily;
    text-transform: none;
    font-weight: normal;
  }
  line-height: 15px;
  margin: 2px 0 22px 0;
}

.row-fluid .container {
  margin-left: 0;
}

h6 {
  color: $bodyBackground;
  display: inline-block;
}

p a {
  text-decoration: underline;
}

.row-fluid .container {
  margin-left: 0;
}

.dpd-panel {
  margin-bottom: 0;
}

.dpd-panel.stacked {
  margin-bottom: 20px;
}
.well {
  @extend .dpd-panel;
}


.resource-list .container {
  width: 443px;
}

// Sidebar polish: active, hover, and keyboard focus
#resource-sidebar,
#pre-resource-sidebar {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;

  li {
    width: 100%;
  }

  li.group-type {
    padding: 0.5rem 0.75rem;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: lighten($bodyBackground, 15%);
  }

  li.resource {
    border-radius: 0.5rem;
    background: rgba($black, 0.35);
    color: lighten($bodyBackground, 10%);
    transition: background .15s ease, color .15s ease;

    .resource-entry {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      padding: 0.5rem 0.75rem;
      border-left: 3px solid transparent;
    }

    .resource-link {
      display: inline-flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.4rem;
      color: inherit;
      text-decoration: none;
    }

    .resource-path {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .res-separator {
      opacity: 0.6;
    }

    .options {
      opacity: 0;
      color: lighten($bodyBackground, 30%);
      transition: opacity .15s ease, color .15s ease;
    }

    &:hover .resource-entry,
    &.active .resource-entry,
    &.nav-focus .resource-entry {
      color: $bodyBackground;
    }

    &:hover .resource-entry {
      background: lighten($black, 5%);
    }

    &:hover .options,
    .options:focus-visible {
      opacity: 1;
      color: $bodyBackground;
    }

    &.active .resource-entry {
      border-left-color: $blue;
      background: lighten($black, 7%);
      font-weight: 600;
    }

    &.nav-focus .resource-entry {
      border-left-color: lighten($blue, 10%);
      background: lighten($black, 9%);
    }

    .resource-entry:focus-within {
      outline: 2px solid $blue;
      outline-offset: 2px;
    }
  }

  ul.pages {
    margin: 0.25rem 0 0.5rem 1.5rem;
    padding: 0.5rem 0 0.5rem 0.75rem;
    border-left: 1px solid rgba($bodyBackground, 0.2);
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
  }

  ul.pages .nav-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: lighten($bodyBackground, 10%);
    font-size: 0.85rem;
    padding: 0.35rem 0.5rem;
    border-radius: 0.35rem;
    background: transparent;
    transition: background .15s ease, color .15s ease;
  }
  ul.pages .nav-link:hover {
    background: rgba($white, 0.08);
    color: $bodyBackground;
  }
  ul.pages .nav-link.active {
    background: lighten($black, 12%);
$dashboard-icon-map: (
  fallback: "\f2cc",
  collection: "\f2cc",
  "users-collection": "\f4cf",
  usercollection: "\f4cf",
  "user-collection": "\f4cf",
  api: "\f2ee",
  array: "\f478",
  boolean: "\f5d6",
  data: "\f8c4",
  date: "\f1e8",
  events: "\f46d",
  files: "\f38b",
  static: "\f38b",
  number: "\f67f",
  object: "\f1c9",
  password: "\f44f",
  properties: "\f473",
  string: "\f3da",
  basic: "\f56b",
  default: "\f352"
);

.icon-custom {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.3rem;
  height: 1.3rem;
  border-radius: 0.35rem;
  font-size: 0.95rem;
  color: $bodyBackground;
  background: rgba($white, 0.1);
  line-height: 1;
  &::before {
    font-family: "bootstrap-icons";
    font-style: normal;
    font-weight: 400;
    line-height: 1;
    display: inline-block;
    content: map-get($dashboard-icon-map, fallback);
  }
}

.icon-custom[data-icon] {
  color: inherit;
}

@each $name, $glyph in $dashboard-icon-map {
  .icon-custom[data-icon='#{$name}']::before {
    content: $glyph;
  }
}

    color: $bodyBackground;
  }
}

// Sidebar search field in dark theme
#resource-sidebar-container .input-group .form-control {
  background: darken($black, 10%);
  color: $white;
  border-color: darken($black, 20%);
}
#resource-sidebar-container .input-group .input-group-text {
  background: darken($black, 15%);
  color: $white;
  border-color: darken($black, 20%);
}

// DARK CHANGES
.panel,
.dpd-panel {
  background: rgba(255, 255, 247, 0.05);
  box-shadow: none;
  box-shadow: inset 1px 1px 1px rgba(0, 0, 0, .25);
  border: solid 1px rgba(0, 0, 0, .5);
}

.alert {
  margin-bottom: 10px;
}

// Accessibility: increase contrast for dark theme
// Links
a {
  color: lighten($blue, 20%);
}
a:hover,
a:focus {
  color: lighten($blue, 30%);
  text-decoration: underline;
}

// Dark containers
.panel,
.dpd-panel,
.notification,
#events,
#default-editor,
#basic-dashboard {
  color: $white;
}

// Inputs on dark backgrounds
input,
textarea,
select {
  background: #1b1b1b;
  color: $white;
  border-color: #444;
}
input::placeholder,
textarea::placeholder {
  color: lighten($white, 35%);
}
input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: lighten($blue, 10%);
  box-shadow: 0 0 0 2px rgba(66, 158, 150, 0.35);
}

// Tables
table,
th,
tr,
td {
  border-color: #444 !important;
}
td,
th {
  color: $white !important;
}
.table-striped tbody tr:nth-child(odd) td,
.table-striped tbody tr:nth-child(odd) th {
  background-color: #121212;
}
.table-striped tbody tr:nth-child(even) td,
.table-striped tbody tr:nth-child(even) th {
  background-color: #0d0d0d;
}

// Event tabs
#event-nav a {
  color: lighten($blue, 15%);
}
#event-nav a:hover,
#event-nav a:focus {
  color: lighten($blue, 30%);
}

// Focus visibility for interactive elements
a:focus-visible,
button:focus-visible,
input:focus-visible {
  outline: 2px solid lighten($blue, 10%);
  outline-offset: 2px;
}

// Respect system high-contrast preference
@media (prefers-contrast: more) {
  a { color: lighten($blue, 35%); }
  .panel, .dpd-panel, .notification { border-color: #666; }
  input, textarea, select { border-color: #666; }
}

// Component-specific contrast tuning

// Alerts (support both legacy and Bootstrap 5 variants)
.alert,
.alert-info,
.alert-success,
.alert-warning,
.alert-danger,
.alert-primary,
.alert-secondary,
.alert-dark,
.alert-light {
  color: $white;
  border-color: #3a3a3a;
  background-color: #1a1a1a;
}
.alert-info { border-left: 4px solid lighten($blue, 10%); }
.alert-success { border-left: 4px solid lighten($green, 10%); }
.alert-warning { border-left: 4px solid $yellow; color: #111; background-color: #ffe9a6; }
.alert-danger, .alert-error { border-left: 4px solid lighten($red, 5%); }
.alert-primary { border-left: 4px solid lighten($blue, 5%); }
.alert-secondary { border-left: 4px solid #888; }
.alert-dark { border-left: 4px solid #bbb; }
.alert-light { border-left: 4px solid #666; color: #111; }

// Dropdown menus
.dropdown-menu {
  background-color: #161616;
  border-color: #2e2e2e;
}
.dropdown-menu .dropdown-item {
  color: $white;
}
.dropdown-menu .dropdown-item:hover,
.dropdown-menu .dropdown-item:focus {
  background-color: #262626;
  color: $white;
}
.dropdown-divider { border-top-color: #2e2e2e; }

// Buttons
.btn {
  border-width: 1px;
}
.btn-primary { background-color: $blue; border-color: lighten($blue, 5%); }
.btn-primary:hover { background-color: lighten($blue, 5%); border-color: lighten($blue, 10%); }
.btn-success { background-color: $green; border-color: lighten($green, 5%); }
.btn-success:hover { background-color: lighten($green, 5%); border-color: lighten($green, 10%); }
.btn-secondary { background-color: #2a2a2a; border-color: #3a3a3a; color: $white; }
.btn-secondary:hover { background-color: #343434; }

// Modal polish (for auth.html static modal)
.modal {
  background-color: #111;
  color: $white;
}
.modal .modal-header,
.modal .modal-footer { border-color: #2a2a2a; }
.modal .modal-body { color: $white; }

// Tooltips
.tooltip .tooltip-inner {
  background-color: #222;
  color: $white;
}
.tooltip .tooltip-arrow::before { border-bottom-color: #222 !important; }

.dpd-panel {
  padding: 10px 20px 20px;
}

h3 {
  color: $bodyBackground
}

table,
th,
tr,
td {
  border-color: $black !important;
}

td,
th {
  color: $white !important;
}

.table-striped tbody tr:nth-child(odd) td,
.table-striped tbody tr:nth-child(odd) th {
  background-color: darken($black, 10%);
}

.table-striped tbody tr:hover td {
  background: inherit !important;
}

input,
textarea {
  background: darken($black, 10%);
  color: $white;
  border: solid 1px $black;
}

#dialog,
.modal {
  input,
  textarea {
    background-color: #ffffff;
    color: $textColor;
  }
}

label {
  color: $white !important;
}

td {
  vertical-align: middle !important;
}

// END DARK
#resource-sidebar,

#sidebar-well {
  background: none;
}

.right-sidebar .dpd-panel {
  position: absolute;
  top: 0;
  width: 195px;
}

.right-sidebar .dpd-panel input {
  width: 185px;
}

.right-sidebar .dpd-panel+.dpd-panel {
  margin-top: 10px;
  top: 165px;
  bottom: 0;
  min-height: 100px;
}

::-webkit-scrollbar {
  background: $black;
  width: 8px;
  height: 8px;
  margin: 10px;
}

::-webkit-scrollbar-thumb {
  background: darken($black, 20%);
  border-radius: 5px;
}

::-webkit-scrollbar-corner {
  display: none;
}

.nav-list .nav-list>li>a {
  text-transform: none;
  font-weight: normal;
  font-size: $baseFontSize;
}

textarea.full-width {
  width: 100%;
}

.code {
  font-family: 'Courier New', monospace;
}

#undo-btn {
  margin: 4px;
}

#save-status {
  margin: 8px 23px 8px 8px;
  display: inline-block;
  color: $white;
  &.inactive {
    opacity: 0.5;
  }
}

.full-width-container {
  @extend .container;
  width: auto;
}

.ide-container {
  position: absolute;
  top: 40px;
  left: 10px;
  right: 10px;
  bottom: 10px;
  min-width: 600px;
  overflow: auto;
}

.ide-container .sidebar {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 210px; // - $wellPadding*2 - 10;
  overflow-y: auto;
}

.ide-container .right-sidebar {
  .ide-container {
    @extend .sidebar;
  }
  width: 250px;
  right: 0;
  overflow-y: hidden;
  overflow-x: hidden;
  border: none;
}

.ide-container .component-type-sidebar {
  .component-type-header {
    &:hover {
      background-image: none;
    }
  }
  .component-type-list {
    margin: 0;
    list-style: none;
    li.component-type-item {
      width: auto;
      background: $black;
      color: $bodyBackground;
      i {
        margin-right: 3px;
        cursor: pointer;
      }
      &:hover {
        background: $blue;
        color: $bodyBackground;
      }
    }
  }
}

/* Icon styles now use Bootstrap Icons via <i class="bi bi-*"></i> */

li.component-type-item {
  list-style: none;
  padding: 10px;
  height: 19px;
  width: 180px;
  color: $bodyBackground;
  background: $black;
  margin-bottom: 4px;
  border-radius: 3px;
  cursor: pointer;
}

.header-offset {
  padding-bottom: 38px;
}

.component-list-empty {
  //  margin: 60px;
}

.ide-container .main-area {
  position: absolute;
  right: 0;
  top: 0;
  left: 260px;
  bottom: 0;
  &.mid {
    right: 260px;
  }
  &.vertical-split {
    .top-panel,
    .bottom-panel {
      position: absolute;
      overflow-y: auto;
      left: 0;
      right: 0;
    }
    .top-panel {
      top: 0;
      overflow-y: hidden;
    }
    .dpd-panel {
      overflow-y: auto;
    }
    .bottom-panel {
      bottom: 0;
    }
    .divider {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0; //border-top: #ddd 2px dotted;
      height: 20px; // background-color: #eee;
      cursor: ns-resize;
      &:after {
        content: '';
        display: block;
        margin-top: 9px;
        border-top: #000 2px dotted;
      }
    }
  }
}

#current-data {
  .table-container {
    overflow-x: scroll;
  }
  table {
    margin-bottom: 10px;
    td,
    th {
      white-space: nowrap;
      .alert {
        margin-bottom: 0;
      }
    }
  }
  #current-data-querystring {
    display: block;
    margin-top: 10px;
    width: 100%;
    margin-bottom: 0; // background: darken($background, 20%);
  }
}

.split-panel {
  position: relative;
  width: 50%;
  float: left;
}

.component-list {
  margin: 0;
  list-style: none;
  .type-selector {
    margin-right: 4px;
  }
}

.ide-container .component-list {
  position: absolute;
  top: 66px;
  bottom: 21px;
  left: 21px;
  right: 21px;
  padding-bottom: 40px;
}

.placeholder {
  padding: 10px;
  border: 1px dashed darken($white, 65%);
  background: url(../img/fabric.png);
  margin-bottom: 4px;
  min-height: 19px;
  border-radius: 3px;
  &.highlight {
    border-color: $linkColor;
    color: $linkColor;
  }
  &.new-item {
    margin-top: 10px;
  }
}

.component-item-header {
  &:hover .handle {
    display: inline-block;
  }
  .handle {
    cursor: row-resize;
    margin-top: -1px;
    display: none;
  }
  .delete-btn {
    cursor: pointer;
  }
  input,
  select,
  label {
    margin-bottom: 0;
    margin-right: 4px;
  }
  .checkbox {
    margin-top: 6px;
  }
}

.component-item-edit {
  display: -webkit-box;
  display: -moz-box;
  display: box;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  box-orient: horizontal;
  width: 100%;
  input[type="text"] {
    width: 50px !important;
    -webkit-box-flex: 1;
    -moz-box-flex: 1;
    box-flex: 1;
    display: block;
  }
  input[type="text"],
  label,
  button {
    margin-right: 4px;
  }
  >.type-selector,
  >button,
  >label,
  >a {
    display: block;
  }
}

li.component-item {
  list-style: none;
  margin-bottom: 4px; // background: rgba(255, 255, 255, 0.1);
  // background: rgba(66, 152, 153, 0.1);
  background: url(../img/fabric.png);
  box-shadow: inset 1px 1px 10px rgba(0, 0, 0, .5);
  color: $bodyBackground;
  border-radius: 3px; // border: solid 1px $textColor;
  border-top: solid 1px rgba(0, 0, 0, .7);
  border-left: solid 1px rgba(0, 0, 0, .7);
  border-bottom: solid 1px darken($white, 78%);
  border-right: solid 1px darken($white, 78%);
  &.active {
    .component-item-header {
      // @include border-radius(3px 3px 0px 0px);
      background: rgba(0, 0, 0, 0.25);
      .checkbox {
        color: #ffffff;
      }
      .delete-btn i {
        margin-top: 6px;
      }
    }
  }
  &.unsaved {
    border: dashed 1px $bodyBackground;
  }
  .name,
  .path {
    cursor: text;
    margin-left: 6px;
  }
  &:hover .name,
  &:hover .path {
    border: dashed 1px $black;
    background: rgba(0, 0, 0, 0.5);
    color: $white;
    margin-left: 0;
    padding: 5px;
  }
  .component-item-header {
    border-radius: inherit;
    padding: 10px;
    min-height: 19px;
    cursor: pointer;
    &:hover {
      background: rgba(0, 0, 0, 0.25);
    }
  }
  .detail {
    border-radius: 0px 0px 3px 3px;
    padding: 10px;
    color: $bodyBackground;
  }
  .detail label {
    color: $bodyBackground;
  }
}

#property-list {
  .locked:hover {
    .name,
    .path {
      border: none;
      margin-left: 0;
      padding: 5px;
      background: none;
    }
  }
  .locked .component-item-header {
    background: rgba(0, 0, 0, 0.25);
    cursor: normal !important;
  }
}

.editor-container {
  position: relative;
  height: calc(100vh - 250px);
  min-height: 400px;
  width: 100%;
  background: #141414;
  .ace_editor {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
  }
}

table {
  .error-tooltip:hover {
    text-decoration: none;
    cursor: pointer;
  }
}

table input {
  margin: 0;
  width: 150px;
  &[type=number] {
    width: 75px;
  }
}

.fixed2 {
  position: fixed;
  width: 16%;
}

  #file-status {
    margin-left: 10px;
    margin-top: 6px;
    i {
      color: white;
    }
  }

#file-nav {
  margin-bottom: 20px;
}

// Mobile touch support for table editing
@media (max-width: 768px) {
  .name,
  .path {
    cursor: pointer !important;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.3);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

    &.touch-active {
      border: dashed 1px $black !important;
      background: rgba(0, 0, 0, 0.5) !important;
      color: $white !important;
      margin-left: 0 !important;
      padding: 5px !important;
    }
  }

  .component-item-header {
    cursor: pointer !important;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.3);
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  .mobile-edit-input {
    border-radius: 3px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    font-size: 14px !important;

    &:focus {
      outline: none;
      border-color: #007acc !important;
      box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.2);
    }
  }

  // Improve touch targets for mobile
  .resource a,
  .options {
    min-height: 44px;
    padding: 12px 8px;
    display: flex;
    align-items: center;
  }

  // Better spacing for mobile
  .component-item {
    margin-bottom: 8px;

    .component-item-header {
      padding: 12px 10px;
      min-height: 44px;
    }
  }
}

.file-list .container {
  width: 507px;
  table {
    margin-bottom: 0;
    td {
      vertical-align: middle;
    }
  }
}

.cta-link {
  text-decoration: underline;
}

.get-started {
  @extend .dpd-panel;
  background: $black;
  color: $bodyBackground;
}

.get-started,
.get-started-light {
  margin: 10px 0;
  padding: 19px 19px 9px 19px;
  color: $white;
}

.tutorial-help {
  text-align: center;
  width: 250px;
  margin: auto;
  color: $white;
}

#properties {
  width: 485px;
  max-width: 485px;
  label {
    margin-right: 12px;
  }
  .label {
    margin-left: 10px;
  }
  input[type=text] {
    width: 201px;
    margin-left: 5px;
  }
}

.sidebar-nav {
  margin-right: 20px;
  height: 133px;
}

#property-now-what {
  display: block;
  width: 242px;
  padding-right: 14px;
  margin: 20px auto;
}

.modal-header {
  h3 {
    color: $black;
  }
}

#api {
  table {
    margin-bottom: 0;
  }
}

.tab-content.tab-content-styled {
  background: rgba(0, 0, 0, 0.25);
  padding: 20px;
  margin: 0;
  border-radius: 5px;
}

#events-panel {}

#event-nav {
  border-bottom: none;
  margin: 0 -20px;
  padding: 0 20px;
  a {
    font-size: 10px;
    text-transform: uppercase;
    font-weight: bold;
    color: $white;
    opacity: 0.5;
    &:hover {
      background: none;
      border-color: transparent;
      opacity: 1;
    }
  }
  li.active {
    margin-bottom: 0;
    a {
      opacity: 1;
      background: rgba(0, 0, 0, 0.25) !important;
      border-color: rgba(0, 0, 0, 0.25);
      border-bottom-color: transparent;
      background: none;
    }
  }
}

pre {
  background: $black !important;
  color: $white;
}

#js-examples,
#api {
  color: $white;
}

.prettyprint {
  border-color: $black !important;
  background: #141414 !important;
  padding: 10px !important;
}

#basic-dashboard {
  width: 485px;
  #settings-form {
    margin-bottom: 0;
  }
  .form-actions {
    background-color: inherit;
    border-color: #333;
    margin-bottom: 0;
    padding-bottom: 0;
  }
}


